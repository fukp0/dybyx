<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Media - Panel Admin</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .table-row-hover:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .modal-overlay {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }
        
        .sidebar {
            transition: all 0.3s ease;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                transform: translateX(-100%);
            }
            .sidebar.open {
                transform: translateX(0);
            }
        }
    </style>
</head>
<body class="text-gray-100">
    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay">
        <div class="glass-effect rounded-2xl p-8 max-w-md w-full card-hover">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-gradient-to-r from-red-500 to-pink-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-lock text-3xl"></i>
                </div>
                <h2 class="text-3xl font-bold font-['Poppins']">Accès Admin</h2>
                <p class="text-gray-400 mt-2">Veuillez entrer le mot de passe administrateur</p>
            </div>
            
            <div id="loginError" class="hidden p-4 rounded-lg bg-red-500/20 border border-red-500/30 mb-4">
                <div class="flex items-center">
                    <i class="fas fa-exclamation-circle mr-3 text-red-400"></i>
                    <p class="text-red-300">Mot de passe incorrect</p>
                </div>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2">Mot de passe</label>
                    <input type="password" id="adminPassword" class="w-full px-4 py-3 rounded-lg bg-white/5 border border-gray-700 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500/20" placeholder="••••••••" autofocus>
                </div>
                
                <button id="loginBtn" class="w-full py-3 bg-gradient-to-r from-red-600 to-pink-600 rounded-lg font-semibold hover:opacity-90 transition-opacity">
                    <i class="fas fa-sign-in-alt mr-2"></i>Se connecter
                </button>
            </div>
        </div>
    </div>

    <!-- Main Layout -->
    <div id="mainLayout" class="hidden">
        <!-- Top Bar -->
        <div class="glass-effect py-4 px-6">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <button id="sidebarToggle" class="lg:hidden p-2 rounded-lg hover:bg-white/10 transition-colors">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <div class="flex items-center space-x-2">
                        <div class="w-10 h-10 bg-gradient-to-r from-red-500 to-pink-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-lock text-xl"></i>
                        </div>
                        <h1 class="text-2xl font-bold font-['Poppins']">Admin<span class="text-red-300">Panel</span></h1>
                    </div>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="hidden md:flex items-center space-x-4">
                        <div class="px-4 py-2 rounded-lg bg-white/5">
                            <i class="fas fa-database mr-2"></i>
                            <span id="totalFiles">0 fichiers</span>
                        </div>
                        <div class="px-4 py-2 rounded-lg bg-white/5">
                            <i class="fas fa-hdd mr-2"></i>
                            <span id="totalStorage">0 MB</span>
                        </div>
                    </div>
                    
                    <button id="logoutBtn" class="px-4 py-2 rounded-lg bg-gradient-to-r from-red-600 to-pink-600 hover:opacity-90 transition-opacity">
                        <i class="fas fa-sign-out-alt mr-2"></i>Déconnexion
                    </button>
                </div>
            </div>
        </div>

        <div class="container mx-auto px-4 py-6 flex">
            <!-- Sidebar -->
            <div id="sidebar" class="sidebar w-64 flex-shrink-0 lg:block fixed lg:relative inset-y-0 left-0 z-40 lg:z-auto bg-gray-900 lg:bg-transparent p-6 lg:p-0 overflow-y-auto">
                <div class="space-y-6">
                    <!-- User Info -->
                    <div class="glass-effect rounded-xl p-4">
                        <div class="flex items-center">
                            <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-red-500 to-pink-600 flex items-center justify-center mr-3">
                                <i class="fas fa-user-shield text-xl"></i>
                            </div>
                            <div>
                                <p class="font-bold">Administrateur</p>
                                <p class="text-sm text-gray-400">Super Admin</p>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <nav class="space-y-2">
                        <a href="#" id="navDashboard" class="nav-item flex items-center p-3 rounded-lg bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-500/30">
                            <i class="fas fa-tachometer-alt mr-3 text-red-400"></i>
                            <span>Tableau de bord</span>
                        </a>
                        <a href="#" id="navFiles" class="nav-item flex items-center p-3 rounded-lg hover:bg-white/5 transition-colors">
                            <i class="fas fa-folder mr-3 text-blue-400"></i>
                            <span>Gestion fichiers</span>
                        </a>
                        <a href="#" id="navStats" class="nav-item flex items-center p-3 rounded-lg hover:bg-white/5 transition-colors">
                            <i class="fas fa-chart-pie mr-3 text-green-400"></i>
                            <span>Statistiques</span>
                        </a>
                        <a href="#" id="navSettings" class="nav-item flex items-center p-3 rounded-lg hover:bg-white/5 transition-colors">
                            <i class="fas fa-cog mr-3 text-yellow-400"></i>
                            <span>Paramètres</span>
                        </a>
                    </nav>

                    <!-- Quick Actions -->
                    <div class="glass-effect rounded-xl p-4">
                        <h3 class="font-bold mb-3">Actions rapides</h3>
                        <div class="space-y-2">
                            <button id="refreshBtn" class="w-full flex items-center p-2 rounded-lg hover:bg-white/5 transition-colors">
                                <i class="fas fa-sync-alt mr-3"></i>
                                <span>Actualiser</span>
                            </button>
                            <button id="deleteAllBtn" class="w-full flex items-center p-2 rounded-lg hover:bg-white/5 transition-colors text-red-400">
                                <i class="fas fa-trash-alt mr-3"></i>
                                <span>Vider le stockage</span>
                            </button>
                        </div>
                    </div>

                    <!-- System Status -->
                    <div class="glass-effect rounded-xl p-4">
                        <h3 class="font-bold mb-3">Statut système</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-sm">Serveur</span>
                                <span class="text-green-400 font-semibold">
                                    <i class="fas fa-circle text-xs mr-1"></i>En ligne
                                </span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm">CORS</span>
                                <span class="text-green-400 font-semibold">Activé</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-sm">Taille max</span>
                                <span class="font-semibold">2 GB</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="flex-1 lg:ml-6">
                <!-- Dashboard Panel -->
                <div id="dashboardPanel" class="fade-in">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <!-- Stats Cards -->
                        <div class="glass-effect rounded-2xl p-6 card-hover">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-cyan-500 flex items-center justify-center mr-4">
                                    <i class="fas fa-file-alt text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-400">Total Fichiers</p>
                                    <p id="statFiles" class="text-3xl font-bold">0</p>
                                </div>
                            </div>
                        </div>

                        <div class="glass-effect rounded-2xl p-6 card-hover">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-green-500 to-emerald-500 flex items-center justify-center mr-4">
                                    <i class="fas fa-hdd text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-400">Stockage utilisé</p>
                                    <p id="statStorage" class="text-3xl font-bold">0 MB</p>
                                </div>
                            </div>
                        </div>

                        <div class="glass-effect rounded-2xl p-6 card-hover">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center mr-4">
                                    <i class="fas fa-chart-line text-xl"></i>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-400">Dernier upload</p>
                                    <p id="statLastUpload" class="text-3xl font-bold">-</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- File Type Distribution -->
                    <div class="glass-effect rounded-2xl p-6 mb-8 card-hover">
                        <h3 class="text-xl font-bold mb-6">Distribution par type</h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="text-center p-4 rounded-xl bg-blue-500/10 border border-blue-500/20">
                                <i class="fas fa-image text-3xl text-blue-400 mb-2"></i>
                                <p class="text-2xl font-bold" id="typeImages">0</p>
                                <p class="text-sm text-gray-400">Images</p>
                            </div>
                            <div class="text-center p-4 rounded-xl bg-purple-500/10 border border-purple-500/20">
                                <i class="fas fa-video text-3xl text-purple-400 mb-2"></i>
                                <p class="text-2xl font-bold" id="typeVideos">0</p>
                                <p class="text-sm text-gray-400">Vidéos</p>
                            </div>
                            <div class="text-center p-4 rounded-xl bg-green-500/10 border border-green-500/20">
                                <i class="fas fa-music text-3xl text-green-400 mb-2"></i>
                                <p class="text-2xl font-bold" id="typeAudio">0</p>
                                <p class="text-sm text-gray-400">Audio</p>
                            </div>
                            <div class="text-center p-4 rounded-xl bg-yellow-500/10 border border-yellow-500/20">
                                <i class="fas fa-file text-3xl text-yellow-400 mb-2"></i>
                                <p class="text-2xl font-bold" id="typeOther">0</p>
                                <p class="text-sm text-gray-400">Autres</p>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="glass-effect rounded-2xl p-6 card-hover">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold">Activité récente</h3>
                            <button id="refreshActivity" class="px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
                                <i class="fas fa-sync-alt mr-2"></i>Actualiser
                            </button>
                        </div>
                        <div id="activityList" class="space-y-4">
                            <!-- Activity items will be loaded here -->
                        </div>
                    </div>
                </div>

                <!-- Files Management Panel -->
                <div id="filesPanel" class="fade-in hidden">
                    <div class="glass-effect rounded-2xl p-6 card-hover">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-bold">Gestion des fichiers</h3>
                            <div class="flex space-x-3">
                                <div class="relative">
                                    <input type="text" id="searchFiles" placeholder="Rechercher..." class="px-4 py-2 rounded-lg bg-white/5 border border-gray-700 focus:border-blue-500 focus:outline-none w-64">
                                    <i class="fas fa-search absolute right-3 top-3 text-gray-500"></i>
                                </div>
                                <select id="filterType" class="px-4 py-2 rounded-lg bg-white/5 border border-gray-700 focus:border-blue-500 focus:outline-none">
                                    <option value="all">Tous les types</option>
                                    <option value="image">Images</option>
                                    <option value="video">Vidéos</option>
                                    <option value="audio">Audio</option>
                                    <option value="other">Autres</option>
                                </select>
                            </div>
                        </div>

                        <div class="overflow-x-auto rounded-xl">
                            <table class="w-full">
                                <thead class="bg-white/5">
                                    <tr>
                                        <th class="py-3 px-4 text-left">
                                            <input type="checkbox" id="selectAll">
                                        </th>
                                        <th class="py-3 px-4 text-left">Nom du fichier</th>
                                        <th class="py-3 px-4 text-left">Type</th>
                                        <th class="py-3 px-4 text-left">Taille</th>
                                        <th class="py-3 px-4 text-left">Date</th>
                                        <th class="py-3 px-4 text-left">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="filesTable" class="divide-y divide-gray-800">
                                    <!-- Files will be loaded here -->
                                </tbody>
                            </table>
                        </div>

                        <div class="flex justify-between items-center mt-6">
                            <div>
                                <span id="selectedCount">0</span> fichier(s) sélectionné(s)
                            </div>
                            <div class="flex space-x-3">
                                <button id="deleteSelected" class="px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                    <i class="fas fa-trash-alt mr-2"></i>Supprimer sélection
                                </button>
                                <button id="downloadSelected" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                    <i class="fas fa-download mr-2"></i>Télécharger
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Panel -->
                <div id="statsPanel" class="fade-in hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Detailed Stats -->
                        <div class="glass-effect rounded-2xl p-6 card-hover">
                            <h3 class="text-xl font-bold mb-6">Statistiques détaillées</h3>
                            <div id="detailedStats" class="space-y-4">
                                <!-- Stats will be loaded here -->
                            </div>
                        </div>

                        <!-- Storage Usage -->
                        <div class="glass-effect rounded-2xl p-6 card-hover">
                            <h3 class="text-xl font-bold mb-6">Utilisation du stockage</h3>
                            <div class="space-y-6">
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span>Images</span>
                                        <span id="storageImages">0 MB</span>
                                    </div>
                                    <div class="w-full bg-gray-700 rounded-full h-3">
                                        <div id="progressImages" class="h-3 rounded-full bg-blue-500" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span>Vidéos</span>
                                        <span id="storageVideos">0 MB</span>
                                    </div>
                                    <div class="w-full bg-gray-700 rounded-full h-3">
                                        <div id="progressVideos" class="h-3 rounded-full bg-purple-500" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between mb-2">
                                        <span>Audio</span>
                                        <span id="storageAudio">0 MB</span>
                                    </div>
                                    <div class="w-full bg-gray-700 rounded-full h-3">
                                        <div id="progressAudio" class="h-3 rounded-full bg-green-500" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings Panel -->
                <div id="settingsPanel" class="fade-in hidden">
                    <div class="glass-effect rounded-2xl p-6 card-hover">
                        <h3 class="text-xl font-bold mb-6">Paramètres du serveur</h3>
                        
                        <div class="space-y-6">
                            <!-- Server Info -->
                            <div class="p-4 rounded-xl bg-white/5">
                                <h4 class="font-bold mb-3 text-lg">Informations serveur</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <p class="text-sm text-gray-400">Dossier upload</p>
                                        <p id="serverUploadDir" class="font-semibold">./uploads</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-400">Port</p>
                                        <p id="serverPort" class="font-semibold">3000</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-400">CORS</p>
                                        <p class="font-semibold text-green-400">Activé</p>
                                    </div>
                                    <div>
                                        <p class="text-sm text-gray-400">Taille max fichier</p>
                                        <p class="font-semibold">2 GB</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Danger Zone -->
                            <div class="p-4 rounded-xl bg-red-500/10 border border-red-500/20">
                                <h4 class="font-bold mb-3 text-lg text-red-300">Zone de danger</h4>
                                <p class="text-gray-300 mb-4">Ces actions sont irréversibles. Soyez certain de ce que vous faites.</p>
                                
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-semibold">Vider le stockage</p>
                                            <p class="text-sm text-gray-400">Supprime tous les fichiers uploadés</p>
                                        </div>
                                        <button id="clearAllBtn" class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors">
                                            <i class="fas fa-bomb mr-2"></i>Vider
                                        </button>
                                    </div>
                                    
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="font-semibold">Changer mot de passe admin</p>
                                            <p class="text-sm text-gray-400">Définir un nouveau mot de passe</p>
                                        </div>
                                        <button id="changePasswordBtn" class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 rounded-lg transition-colors">
                                            <i class="fas fa-key mr-2"></i>Changer
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Server Actions -->
                            <div class="p-4 rounded-xl bg-blue-500/10 border border-blue-500/20">
                                <h4 class="font-bold mb-3 text-lg text-blue-300">Actions serveur</h4>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <button id="restartServer" class="flex items-center justify-center p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
                                        <i class="fas fa-redo-alt mr-3"></i>
                                        <span>Redémarrer le serveur</span>
                                    </button>
                                    
                                    <button id="backupServer" class="flex items-center justify-center p-4 rounded-lg bg-white/5 hover:bg-white/10 transition-colors">
                                        <i class="fas fa-database mr-3"></i>
                                        <span>Sauvegarder les données</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay hidden">
        <div class="glass-effect rounded-2xl p-8 max-w-md w-full card-hover">
            <div class="text-center mb-6">
                <div class="w-16 h-16 bg-gradient-to-r from-red-500 to-pink-600 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-exclamation-triangle text-2xl"></i>
                </div>
                <h3 class="text-2xl font-bold">Confirmer la suppression</h3>
                <p class="text-gray-400 mt-2" id="deleteModalText">Êtes-vous sûr de vouloir supprimer ces fichiers ? Cette action est irréversible.</p>
            </div>
            
            <div class="flex space-x-4">
                <button id="cancelDelete" class="flex-1 py-3 rounded-lg bg-white/10 hover:bg-white/20 transition-colors">
                    Annuler
                </button>
                <button id="confirmDelete" class="flex-1 py-3 bg-gradient-to-r from-red-600 to-pink-600 rounded-lg font-semibold hover:opacity-90 transition-opacity">
                    <i class="fas fa-trash-alt mr-2"></i>Supprimer
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 glass-effect rounded-lg p-4 shadow-xl transform translate-y-full transition-transform duration-300 max-w-sm z-50">
        <div class="flex items-center">
            <div id="toastIcon" class="w-8 h-8 rounded-full flex items-center justify-center mr-3">
                <i id="toastIconClass" class="fas fa-info"></i>
            </div>
            <div>
                <p id="toastTitle" class="font-bold"></p>
                <p id="toastMessage" class="text-sm text-gray-300"></p>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const loginModal = document.getElementById('loginModal');
        const mainLayout = document.getElementById('mainLayout');
        const adminPassword = document.getElementById('adminPassword');
        const loginBtn = document.getElementById('loginBtn');
        const loginError = document.getElementById('loginError');
        const logoutBtn = document.getElementById('logoutBtn');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        
        // Navigation
        const navDashboard = document.getElementById('navDashboard');
        const navFiles = document.getElementById('navFiles');
        const navStats = document.getElementById('navStats');
        const navSettings = document.getElementById('navSettings');
        
        // Panels
        const dashboardPanel = document.getElementById('dashboardPanel');
        const filesPanel = document.getElementById('filesPanel');
        const statsPanel = document.getElementById('statsPanel');
        const settingsPanel = document.getElementById('settingsPanel');
        
        // Dashboard elements
        const statFiles = document.getElementById('statFiles');
        const statStorage = document.getElementById('statStorage');
        const statLastUpload = document.getElementById('statLastUpload');
        const typeImages = document.getElementById('typeImages');
        const typeVideos = document.getElementById('typeVideos');
        const typeAudio = document.getElementById('typeAudio');
        const typeOther = document.getElementById('typeOther');
        const activityList = document.getElementById('activityList');
        const refreshActivity = document.getElementById('refreshActivity');
        
        // Files management
        const searchFiles = document.getElementById('searchFiles');
        const filterType = document.getElementById('filterType');
        const filesTable = document.getElementById('filesTable');
        const selectAll = document.getElementById('selectAll');
        const deleteSelected = document.getElementById('deleteSelected');
        const downloadSelected = document.getElementById('downloadSelected');
        const selectedCount = document.getElementById('selectedCount');
        
        // Stats elements
        const detailedStats = document.getElementById('detailedStats');
        const storageImages = document.getElementById('storageImages');
        const storageVideos = document.getElementById('storageVideos');
        const storageAudio = document.getElementById('storageAudio');
        const progressImages = document.getElementById('progressImages');
        const progressVideos = document.getElementById('progressVideos');
        const progressAudio = document.getElementById('progressAudio');
        
        // Settings elements
        const clearAllBtn = document.getElementById('clearAllBtn');
        const changePasswordBtn = document.getElementById('changePasswordBtn');
        const restartServer = document.getElementById('restartServer');
        const backupServer = document.getElementById('backupServer');
        
        // Modals
        const deleteModal = document.getElementById('deleteModal');
        const deleteModalText = document.getElementById('deleteModalText');
        const cancelDelete = document.getElementById('cancelDelete');
        const confirmDelete = document.getElementById('confirmDelete');
        
        // Toast
        const toast = document.getElementById('toast');
        const toastTitle = document.getElementById('toastTitle');
        const toastMessage = document.getElementById('toastMessage');
        const toastIcon = document.getElementById('toastIcon');
        const toastIconClass = document.getElementById('toastIconClass');
        
        // State
        let isAuthenticated = false;
        let filesData = [];
        let selectedFiles = new Set();
        let currentPanel = 'dashboard';
        
        // Show toast notification
        function showToast(title, message, type = 'info') {
            const colors = {
                success: { bg: 'bg-green-500', icon: 'fa-check' },
                error: { bg: 'bg-red-500', icon: 'fa-times' },
                warning: { bg: 'bg-yellow-500', icon: 'fa-exclamation' },
                info: { bg: 'bg-blue-500', icon: 'fa-info' }
            };
            
            toastIcon.className = `${colors[type].bg} w-8 h-8 rounded-full flex items-center justify-center mr-3`;
            toastIconClass.className = `fas ${colors[type].icon}`;
            toastTitle.textContent = title;
            toastMessage.textContent = message;
            
            toast.classList.remove('translate-y-full');
            setTimeout(() => {
                toast.classList.add('translate-y-full');
            }, 3000);
        }
        
        // Login function
        async function login() {
            const password = adminPassword.value;
            
            try {
                const response = await fetch('/api/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ password })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    isAuthenticated = true;
                    loginModal.style.display = 'none';
                    mainLayout.classList.remove('hidden');
                    showToast('Connexion réussie', 'Bienvenue dans le panel admin', 'success');
                    loadData();
                } else {
                    loginError.classList.remove('hidden');
                    adminPassword.value = '';
                    adminPassword.focus();
                }
            } catch (error) {
                showToast('Erreur', 'Impossible de se connecter au serveur', 'error');
            }
        }
        
        // Logout function
        function logout() {
            isAuthenticated = false;
            mainLayout.classList.add('hidden');
            loginModal.style.display = 'flex';
            loginError.classList.add('hidden');
            adminPassword.value = '';
            selectedFiles.clear();
            filesData = [];
        }
        
        // Load all data
        async function loadData() {
            await Promise.all([
                loadDashboardStats(),
                loadFilesList(),
                loadActivity()
            ]);
        }
        
        // Load dashboard stats
        async function loadDashboardStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                
                if (data.success) {
                    statFiles.textContent = data.stats.totalFiles;
                    statStorage.textContent = data.stats.totalSize;
                    
                    typeImages.textContent = data.stats.byType.image || 0;
                    typeVideos.textContent = data.stats.byType.video || 0;
                    typeAudio.textContent = data.stats.byType.audio || 0;
                    typeOther.textContent = data.stats.byType.other || 0;
                    
                    // Update total in top bar
                    document.getElementById('totalFiles').textContent = `${data.stats.totalFiles} fichiers`;
                    document.getElementById('totalStorage').textContent = data.stats.totalSize;
                }
            } catch (error) {
                console.error('Erreur chargement stats:', error);
            }
        }
        
        // Load files list
        async function loadFilesList() {
            try {
                const response = await fetch('/api/files');
                const data = await response.json();
                
                if (data.success) {
                    filesData = data.files;
                    renderFilesTable(filesData);
                    
                    // Update last upload
                    if (filesData.length > 0) {
                        const lastFile = filesData[0];
                        const date = new Date(lastFile.date);
                        statLastUpload.textContent = date.toLocaleDateString();
                    }
                }
            } catch (error) {
                console.error('Erreur chargement fichiers:', error);
            }
        }
        
        // Render files table
        function renderFilesTable(files) {
            filesTable.innerHTML = '';
            
            if (files.length === 0) {
                filesTable.innerHTML = `
                    <tr>
                        <td colspan="6" class="py-8 text-center text-gray-500">
                            <i class="fas fa-folder-open text-4xl mb-3"></i>
                            <p>Aucun fichier trouvé</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            files.forEach(file => {
                const isSelected = selectedFiles.has(file.name);
                const icon = file.type === 'image' ? 'fa-image' : 
                            file.type === 'video' ? 'fa-video' : 
                            file.type === 'audio' ? 'fa-music' : 'fa-file';
                
                const iconColor = file.type === 'image' ? 'text-blue-400' : 
                                file.type === 'video' ? 'text-purple-400' : 
                                file.type === 'audio' ? 'text-green-400' : 'text-gray-400';
                
                const date = new Date(file.date).toLocaleDateString();
                
                const row = document.createElement('tr');
                row.className = 'table-row-hover';
                row.innerHTML = `
                    <td class="py-3 px-4">
                        <input type="checkbox" class="file-checkbox" data-filename="${file.name}" ${isSelected ? 'checked' : ''}>
                    </td>
                    <td class="py-3 px-4">
                        <div class="flex items-center">
                            <div class="w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center mr-3">
                                <i class="fas ${icon} ${iconColor}"></i>
                            </div>
                            <div class="max-w-xs truncate" title="${file.name}">
                                ${file.name}
                            </div>
                        </div>
                    </td>
                    <td class="py-3 px-4">
                        <span class="px-3 py-1 rounded-full text-xs ${getTypeBadgeClass(file.type)}">
                            ${file.type}
                        </span>
                    </td>
                    <td class="py-3 px-4">${file.size}</td>
                    <td class="py-3 px-4">${date}</td>
                    <td class="py-3 px-4">
                        <div class="flex space-x-2">
                            <button onclick="viewFile('${file.url}')" class="p-2 hover:bg-white/10 rounded-lg transition-colors">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="copyFileUrl('${file.url}')" class="p-2 hover:bg-white/10 rounded-lg transition-colors">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button onclick="deleteFile('${file.name}', '${file.url}')" class="p-2 hover:bg-white/10 rounded-lg transition-colors text-red-400">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                filesTable.appendChild(row);
            });
            
            updateSelectionCount();
        }
        
        // Get badge class for file type
        function getTypeBadgeClass(type) {
            const classes = {
                image: 'bg-blue-500/20 text-blue-300',
                video: 'bg-purple-500/20 text-purple-300',
                audio: 'bg-green-500/20 text-green-300',
                document: 'bg-yellow-500/20 text-yellow-300',
                archive: 'bg-orange-500/20 text-orange-300',
                other: 'bg-gray-500/20 text-gray-300'
            };
            
            return classes[type] || classes.other;
        }
        
        // Load activity
        async function loadActivity() {
            try {
                const response = await fetch('/api/files');
                const data = await response.json();
                
                if (data.success) {
                    activityList.innerHTML = '';
                    
                    data.files.slice(0, 5).forEach(file => {
                        const date = new Date(file.date);
                        const timeAgo = getTimeAgo(date);
                        
                        activityList.innerHTML += `
                            <div class="flex items-center p-4 rounded-lg bg-white/5">
                                <div class="w-10 h-10 rounded-xl ${getActivityIconColor(file.type)} flex items-center justify-center mr-4">
                                    <i class="fas ${getActivityIcon(file.type)}"></i>
                                </div>
                                <div class="flex-1">
                                    <p class="font-semibold">${file.name.substring(0, 30)}${file.name.length > 30 ? '...' : ''}</p>
                                    <p class="text-sm text-gray-400">Uploadé ${timeAgo} • ${file.size}</p>
                                </div>
                                <a href="${file.url}" target="_blank" class="ml-2 p-2 hover:bg-white/10 rounded-lg transition-colors">
                                    <i class="fas fa-external-link-alt"></i>
                                </a>
                            </div>
                        `;
                    });
                }
            } catch (error) {
                console.error('Erreur chargement activité:', error);
            }
        }
        
        // Get activity icon
        function getActivityIcon(type) {
            return type === 'image' ? 'fa-image' : 
                   type === 'video' ? 'fa-video' : 
                   type === 'audio' ? 'fa-music' : 'fa-file-upload';
        }
        
        // Get activity icon color
        function getActivityIconColor(type) {
            return type === 'image' ? 'bg-blue-500/20 text-blue-400' : 
                   type === 'video' ? 'bg-purple-500/20 text-purple-400' : 
                   type === 'audio' ? 'bg-green-500/20 text-green-400' : 
                   'bg-gray-500/20 text-gray-400';
        }
        
        // Get time ago
        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            
            let interval = seconds / 31536000;
            if (interval > 1) return Math.floor(interval) + " an" + (Math.floor(interval) > 1 ? "s" : "");
            
            interval = seconds / 2592000;
            if (interval > 1) return Math.floor(interval) + " mois";
            
            interval = seconds / 86400;
            if (interval > 1) return Math.floor(interval) + " jour" + (Math.floor(interval) > 1 ? "s" : "");
            
            interval = seconds / 3600;
            if (interval > 1) return Math.floor(interval) + " heure" + (Math.floor(interval) > 1 ? "s" : "");
            
            interval = seconds / 60;
            if (interval > 1) return Math.floor(interval) + " minute" + (Math.floor(interval) > 1 ? "s" : "");
            
            return Math.floor(seconds) + " seconde" + (Math.floor(seconds) > 1 ? "s" : "");
        }
        
        // Update selection count
        function updateSelectionCount() {
            const count = selectedFiles.size;
            selectedCount.textContent = count;
            
            deleteSelected.disabled = count === 0;
            downloadSelected.disabled = count === 0;
            
            selectAll.checked = count > 0 && count === filesData.length;
            selectAll.indeterminate = count > 0 && count < filesData.length;
        }
        
        // View file
        function viewFile(url) {
            window.open(url, '_blank');
        }
        
        // Copy file URL
        function copyFileUrl(url) {
            navigator.clipboard.writeText(url).then(() => {
                showToast('Copié', 'URL copiée dans le presse-papier', 'success');
            });
        }
        
        // Delete file
        async function deleteFile(filename, url) {
            deleteModalText.textContent = `Êtes-vous sûr de vouloir supprimer "${filename}" ? Cette action est irréversible.`;
            
            deleteModal.classList.remove('hidden');
            
            const confirm = await new Promise(resolve => {
                confirmDelete.onclick = () => {
                    deleteModal.classList.add('hidden');
                    resolve(true);
                };
                
                cancelDelete.onclick = () => {
                    deleteModal.classList.add('hidden');
                    resolve(false);
                };
            });
            
            if (confirm) {
                try {
                    const response = await fetch(`/api/files/${encodeURIComponent(filename)}`, {
                        method: 'DELETE'
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        showToast('Supprimé', `Fichier "${filename}" supprimé`, 'success');
                        loadData();
                        selectedFiles.delete(filename);
                        updateSelectionCount();
                    } else {
                        showToast('Erreur', data.message, 'error');
                    }
                } catch (error) {
                    showToast('Erreur', 'Impossible de supprimer le fichier', 'error');
                }
            }
        }
        
        // Switch panel
        function switchPanel(panel) {
            // Hide all panels
            dashboardPanel.classList.add('hidden');
            filesPanel.classList.add('hidden');
            statsPanel.classList.add('hidden');
            settingsPanel.classList.add('hidden');
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.className = item.className.replace('bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-500/30', 'hover:bg-white/5');
            });
            
            // Show selected panel
            currentPanel = panel;
            switch(panel) {
                case 'dashboard':
                    dashboardPanel.classList.remove('hidden');
                    navDashboard.className = 'nav-item flex items-center p-3 rounded-lg bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-500/30';
                    break;
                case 'files':
                    filesPanel.classList.remove('hidden');
                    navFiles.className = 'nav-item flex items-center p-3 rounded-lg bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-500/30';
                    break;
                case 'stats':
                    statsPanel.classList.remove('hidden');
                    navStats.className = 'nav-item flex items-center p-3 rounded-lg bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-500/30';
                    break;
                case 'settings':
                    settingsPanel.classList.remove('hidden');
                    navSettings.className = 'nav-item flex items-center p-3 rounded-lg bg-gradient-to-r from-red-600/20 to-pink-600/20 border border-red-500/30';
                    break;
            }
        }
        
        // Event Listeners
        loginBtn.addEventListener('click', login);
        
        adminPassword.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                login();
            }
        });
        
        logoutBtn.addEventListener('click', logout);
        
        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });
        
        // Navigation
        navDashboard.addEventListener('click', (e) => {
            e.preventDefault();
            switchPanel('dashboard');
        });
        
        navFiles.addEventListener('click', (e) => {
            e.preventDefault();
            switchPanel('files');
        });
        
        navStats.addEventListener('click', (e) => {
            e.preventDefault();
            switchPanel('stats');
        });
        
        navSettings.addEventListener('click', (e) => {
            e.preventDefault();
            switchPanel('settings');
        });
        
        // Refresh buttons
        refreshActivity.addEventListener('click', loadActivity);
        document.getElementById('refreshBtn').addEventListener('click', loadData);
        
        // Files table selection
        selectAll.addEventListener('change', (e) => {
            const isChecked = e.target.checked;
            
            if (isChecked) {
                filesData.forEach(file => selectedFiles.add(file.name));
            } else {
                selectedFiles.clear();
            }
            
            renderFilesTable(filesData);
        });
        
        // Handle individual checkbox changes
        filesTable.addEventListener('change', (e) => {
            if (e.target.classList.contains('file-checkbox')) {
                const filename = e.target.dataset.filename;
                
                if (e.target.checked) {
                    selectedFiles.add(filename);
                } else {
                    selectedFiles.delete(filename);
                }
                
                updateSelectionCount();
            }
        });
        
        // Delete selected files
        deleteSelected.addEventListener('click', async () => {
            if (selectedFiles.size === 0) return;
            
            deleteModalText.textContent = `Êtes-vous sûr de vouloir supprimer ${selectedFiles.size} fichier(s) ? Cette action est irréversible.`;
            deleteModal.classList.remove('hidden');
            
            const confirm = await new Promise(resolve => {
                confirmDelete.onclick = () => {
                    deleteModal.classList.add('hidden');
                    resolve(true);
                };
                
                cancelDelete.onclick = () => {
                    deleteModal.classList.add('hidden');
                    resolve(false);
                };
            });
            
            if (confirm) {
                let successCount = 0;
                let errorCount = 0;
                
                for (const filename of selectedFiles) {
                    try {
                        const response = await fetch(`/api/files/${encodeURIComponent(filename)}`, {
                            method: 'DELETE'
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            successCount++;
                        } else {
                            errorCount++;
                        }
                    } catch (error) {
                        errorCount++;
                    }
                }
                
                if (successCount > 0) {
                    showToast('Supprimé', `${successCount} fichier(s) supprimé(s)`, 'success');
                }
                
                if (errorCount > 0) {
                    showToast('Erreur', `${errorCount} fichier(s) n'ont pas pu être supprimés`, 'error');
                }
                
                selectedFiles.clear();
                loadData();
            }
        });
        
        // Search and filter
        searchFiles.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            filterFiles();
        });
        
        filterType.addEventListener('change', filterFiles);
        
        function filterFiles() {
            const searchTerm = searchFiles.value.toLowerCase();
            const typeFilter = filterType.value;
            
            let filtered = filesData;
            
            if (searchTerm) {
                filtered = filtered.filter(file => 
                    file.name.toLowerCase().includes(searchTerm)
                );
            }
            
            if (typeFilter !== 'all') {
                filtered = filtered.filter(file => file.type === typeFilter);
            }
            
            renderFilesTable(filtered);
        }
        
        // Settings actions
        clearAllBtn.addEventListener('click', async () => {
            deleteModalText.textContent = 'Êtes-vous sûr de vouloir supprimer TOUS les fichiers ? Cette action est irréversible et supprimera tout le contenu du serveur.';
            deleteModal.classList.remove('hidden');
            
            const confirm = await new Promise(resolve => {
                confirmDelete.onclick = () => {
                    deleteModal.classList.add('hidden');
                    resolve(true);
                };
                
                cancelDelete.onclick = () => {
                    deleteModal.classList.add('hidden');
                    resolve(false);
                };
            });
            
            if (confirm) {
                showToast('Info', 'Cette fonctionnalité sera implémentée dans une version future', 'info');
            }
        });
        
        // Simulate server info
        document.getElementById('serverUploadDir').textContent = './uploads';
        document.getElementById('serverPort').textContent = window.location.port || 3000;
        
        // Initial setup
        switchPanel('dashboard');
        
        // Auto-refresh data every 30 seconds
        setInterval(() => {
            if (isAuthenticated) {
                loadData();
            }
        }, 30000);
        
        // Welcome message
        setTimeout(() => {
            adminPassword.focus();
        }, 100);
    </script>
</body>
    </html>
