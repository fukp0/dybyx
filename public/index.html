<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DYBYX | MÉDIA CLOUD URL</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');
        
        :root {
            --primary-glow: conic-gradient(from 180deg at 50% 50%, #2a8af6 0deg, #a853ba 180deg, #e92a67 360deg);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #0f172a;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Fond animé complexe */
        .ambient-light {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }

        .blob {
            position: absolute;
            filter: blur(80px);
            opacity: 0.6;
            animation: float 10s infinite ease-in-out alternate;
        }

        .blob-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: #4f46e5; animation-delay: 0s; }
        .blob-2 { bottom: -10%; right: -10%; width: 50vw; height: 50vw; background: #7c3aed; animation-delay: -2s; }
        .blob-3 { top: 40%; left: 40%; width: 30vw; height: 30vw; background: #db2777; animation-delay: -4s; }

        @keyframes float {
            0% { transform: translate(0, 0) scale(1); }
            100% { transform: translate(20px, 40px) scale(1.1); }
        }
        
        /* Glassmorphism Premium */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        
        .glass-card-hover {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .glass-card-hover:hover {
            transform: translateY(-4px);
            background: rgba(255, 255, 255, 0.06);
            border-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
        }

        /* Drop Zone Styles */
        .file-drop-zone {
            background-image: url("data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='16' ry='16' stroke='%23FFFFFF4D' stroke-width='2' stroke-dasharray='12%2c 12' stroke-dashoffset='0' stroke-linecap='square'/%3e%3c/svg%3e");
            transition: all 0.3s ease;
        }
        
        .file-drop-zone.dragover {
            background-image: url("data:image/svg+xml,%3csvg width='100%25' height='100%25' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='100%25' height='100%25' fill='none' rx='16' ry='16' stroke='%236366F1' stroke-width='3' stroke-dasharray='12%2c 12' stroke-dashoffset='0' stroke-linecap='square'/%3e%3c/svg%3e");
            background-color: rgba(99, 102, 241, 0.1);
            transform: scale(0.99);
        }

        /* Typography & Decor */
        .text-gradient {
            background: linear-gradient(to right, #60a5fa, #c084fc, #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .heading-font { font-family: 'Outfit', sans-serif; }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.2); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.4); }

        /* Animations */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-up { animation: slideUp 0.6s ease-out forwards; }
        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
    </style>
</head>
<body class="antialiased selection:bg-indigo-500 selection:text-white">
    
    <!-- Background Animation -->
    <div class="ambient-light">
        <div class="blob blob-1 rounded-full"></div>
        <div class="blob blob-2 rounded-full"></div>
        <div class="blob blob-3 rounded-full"></div>
    </div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 border-b border-white/5 bg-slate-900/50 backdrop-blur-xl">
        <div class="container mx-auto px-6 h-20 flex justify-between items-center">
            <div class="flex items-center space-x-3 group cursor-pointer">
                <div class="relative w-10 h-10 flex items-center justify-center">
                    <div class="absolute inset-0 bg-blue-500 blur-lg opacity-40 group-hover:opacity-60 transition-opacity rounded-full"></div>
                    <div class="relative z-10 w-10 h-10 bg-gradient-to-tr from-blue-600 to-indigo-600 rounded-xl flex items-center justify-center border border-white/10 shadow-lg">
                        <i class="fas fa-cloud text-white text-lg"></i>
                    </div>
                </div>
                <h1 class="text-2xl font-bold heading-font tracking-tight">Cloud<span class="text-blue-400">Media</span></h1>
            </div>
            
            <div class="hidden md:flex items-center space-x-1 bg-white/5 p-1 rounded-xl border border-white/5">
                <a href="/" class="px-5 py-2 rounded-lg bg-indigo-600 text-white shadow-lg shadow-indigo-500/20 text-sm font-medium transition-transform hover:scale-105">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
                <a href="/admin.html" class="px-5 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-white/5 text-sm font-medium transition-colors">
                    <i class="fas fa-shield-alt mr-2"></i>Admin
                </a>
                <a href="/api/test" target="_blank" class="px-5 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-white/5 text-sm font-medium transition-colors">
                    <i class="fas fa-code mr-2"></i>API
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mx-auto px-4 pt-32 pb-12 relative z-10">
        <!-- Hero Section -->
        <div class="text-center mb-16 animate-slide-up">
            <span class="inline-block py-1 px-3 rounded-full bg-blue-500/10 border border-blue-500/20 text-blue-400 text-xs font-semibold uppercase tracking-wider mb-4">Stockage illimité</span>
            <h2 class="text-5xl md:text-7xl font-bold mb-6 heading-font leading-tight">
                Importez vos fichiers <br>
                <span class="text-gradient">en toute sécurité</span>
            </h2>
            <p class="text-lg text-gray-400 max-w-2xl mx-auto leading-relaxed">
                Hébergement haute performance pour vos médias. 
                Profitez d'une vitesse ultra-rapide et d'une limite de <span class="text-white font-semibold">2GB par fichier</span>.
            </p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            <!-- Left Column: Upload (8 cols) -->
            <div class="lg:col-span-8 space-y-8 animate-slide-up delay-100">
                
                <!-- Upload Card -->
                <div class="glass-panel rounded-3xl p-8 relative overflow-hidden group">
                    <div class="absolute top-0 right-0 w-64 h-64 bg-indigo-500/10 blur-3xl rounded-full -mr-32 -mt-32 pointer-events-none"></div>
                    
                    <div class="flex items-center justify-between mb-8">
                        <div>
                            <h3 class="text-2xl font-bold heading-font text-white">Zone de Téléversement</h3>
                            <p class="text-gray-400 text-sm mt-1">Formats supportés : JPG, PNG, MP4, MP3, PDF...</p>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center border border-white/10">
                            <i class="fas fa-bolt text-yellow-400"></i>
                        </div>
                    </div>

                    <!-- Drop Zone -->
                    <div id="dropZone" class="file-drop-zone rounded-2xl p-10 text-center cursor-pointer transition-all hover:bg-white/5 relative">
                        <div class="w-20 h-20 mx-auto bg-gradient-to-tr from-indigo-500 to-purple-500 rounded-full flex items-center justify-center mb-6 shadow-xl shadow-indigo-500/20 group-hover:scale-110 transition-transform duration-300">
                            <i class="fas fa-cloud-upload-alt text-3xl text-white"></i>
                        </div>
                        <h4 class="text-xl font-semibold mb-2 text-white">Glissez vos fichiers ici</h4>
                        <p class="text-gray-400 mb-8 text-sm">ou cliquez pour explorer vos dossiers</p>
                        
                        <input type="file" id="fileInput" class="hidden" multiple>
                        <button id="browseBtn" class="px-8 py-3 bg-white text-slate-900 rounded-xl font-bold hover:bg-gray-100 transition-colors shadow-lg shadow-white/10 flex items-center mx-auto">
                            <i class="fas fa-folder-open mr-2"></i>
                            Parcourir les fichiers
                        </button>
                    </div>

                    <!-- Progress Bar (Hidden by default) -->
                    <div id="progressContainer" class="hidden mt-8 bg-slate-900/50 rounded-xl p-4 border border-white/10">
                        <div class="flex justify-between items-end mb-2">
                            <div>
                                <p id="fileName" class="text-sm font-medium text-white truncate max-w-xs">filename.jpg</p>
                                <p class="text-xs text-gray-500 mt-1">Envoi en cours...</p>
                            </div>
                            <span id="progressPercent" class="text-lg font-bold text-indigo-400">0%</span>
                        </div>
                        <div class="w-full bg-gray-700/50 rounded-full h-2 overflow-hidden">
                            <div id="progressBar" class="h-full rounded-full bg-gradient-to-r from-indigo-500 to-purple-500 shadow-[0_0_10px_rgba(99,102,241,0.5)] transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- File List -->
                    <div id="fileList" class="mt-8 space-y-3">
                        <!-- Les fichiers uploadés apparaîtront ici -->
                    </div>
                </div>

                <!-- Recent Files Section -->
                <div class="glass-panel rounded-3xl p-8">
                    <h3 class="text-xl font-bold mb-6 flex items-center">
                        <i class="fas fa-clock mr-3 text-indigo-400"></i>
                        Fichiers Récents
                    </h3>
                    <div id="recentFiles" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="col-span-full text-center py-10 border border-dashed border-gray-700 rounded-xl">
                            <i class="fas fa-folder-open text-3xl text-gray-600 mb-3"></i>
                            <p class="text-gray-500">Chargement des fichiers...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Sidebar (4 cols) -->
            <div class="lg:col-span-4 space-y-6 animate-slide-up delay-200">
                
                <!-- Stats Card -->
                <div class="glass-panel rounded-3xl p-6 glass-card-hover relative overflow-hidden">
                    <div class="absolute -right-6 -top-6 w-24 h-24 bg-emerald-500/20 blur-2xl rounded-full"></div>
                    <h3 class="text-lg font-bold mb-6 flex items-center text-gray-200">
                        <i class="fas fa-chart-pie mr-3 text-emerald-400"></i>
                        Statistiques
                    </h3>
                    <div class="space-y-4">
                        <div class="p-4 rounded-2xl bg-white/5 border border-white/5 flex justify-between items-center">
                            <span class="text-gray-400 text-sm">Fichiers</span>
                            <span class="font-bold text-xl text-white" id="fileCount">0</span>
                        </div>
                        <div class="p-4 rounded-2xl bg-white/5 border border-white/5 flex justify-between items-center">
                            <span class="text-gray-400 text-sm">Utilisation</span>
                            <span class="font-bold text-xl text-white" id="storageUsed">0 MB</span>
                        </div>
                        <div class="p-4 rounded-2xl bg-emerald-500/10 border border-emerald-500/20 flex justify-between items-center">
                            <span class="text-emerald-200 text-sm">Capacité Max</span>
                            <span class="font-bold text-emerald-400">2 GB</span>
                        </div>
                    </div>
                </div>

                <!-- Integration Snippets -->
                <div class="glass-panel rounded-3xl p-6 glass-card-hover">
                    <h3 class="text-lg font-bold mb-4 flex items-center text-gray-200">
                        <i class="fas fa-code mr-3 text-pink-400"></i>
                        Intégration
                    </h3>
                    <div class="space-y-4 text-xs font-mono">
                        <div class="group relative">
                            <p class="text-gray-500 mb-1 font-sans font-medium">HTML Embed</p>
                            <div class="bg-slate-900 rounded-lg p-3 border border-white/10 text-gray-300 overflow-x-auto">
                                &lt;img src="<span id="exampleUrl" class="text-green-400">/uploads/fichier.jpg</span>"&gt;
                            </div>
                        </div>
                        <div class="group relative">
                            <p class="text-gray-500 mb-1 font-sans font-medium">Markdown</p>
                            <div class="bg-slate-900 rounded-lg p-3 border border-white/10 text-gray-300 overflow-x-auto">
                                ![Img](<span id="exampleUrl2" class="text-blue-400">/uploads/fichier.jpg</span>)
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Footer Links -->
                <div class="text-center pt-4">
                    <div class="flex justify-center space-x-4 mb-4">
                        <a href="https://github.com/Dyby-Tech00" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10 hover:text-blue-400 transition-all">
                            <i class="fab fa-github"></i>
                        </a>
                        <a href="https://instagram.com/dyby_tech" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10 hover:text-blue-400 transition-all">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="https://wa.me/yourself" class="w-10 h-10 rounded-full bg-white/5 flex items-center justify-center hover:bg-white/10 hover:text-blue-400 transition-all">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                    </div>
                    <p class="text-xs text-gray-600">© 2023 Dybyx Server. All rights reserved.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-6 right-6 z-50 transform translate-y-24 opacity-0 transition-all duration-300">
        <div class="glass-panel bg-slate-900/90 rounded-2xl p-4 shadow-2xl border-l-4 border-indigo-500 flex items-center max-w-sm">
            <div id="toastIconContainer" class="w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center mr-4 shrink-0">
                <i id="toastIcon" class="fas fa-check text-indigo-400"></i>
            </div>
            <div>
                <h4 id="toastTitle" class="font-bold text-white text-sm">Succès</h4>
                <p id="toastMessage" class="text-xs text-gray-400 mt-1">Action effectuée avec succès</p>
            </div>
        </div>
    </div>

    <script>
        // ===========================================
        // CONFIGURATION - Compatible avec votre server.js
        // ===========================================
        const API_BASE = window.location.origin; // Utilise l'origine actuelle
        const UPLOAD_ENDPOINT = '/upload'; // Compatible avec votre server.js
        const FILES_ENDPOINT = '/api/files'; // Compatible avec votre server.js
        const STATS_ENDPOINT = '/api/stats'; // Compatible avec votre server.js

        // DOM Elements
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const browseBtn = document.getElementById('browseBtn');
        const progressContainer = document.getElementById('progressContainer');
        const progressBar = document.getElementById('progressBar');
        const progressPercent = document.getElementById('progressPercent');
        const fileNameLabel = document.getElementById('fileName');
        const fileList = document.getElementById('fileList');
        const recentFiles = document.getElementById('recentFiles');
        const statsFileCount = document.getElementById('fileCount');
        const statsStorageUsed = document.getElementById('storageUsed');
        const exampleUrl = document.getElementById('exampleUrl');
        const exampleUrl2 = document.getElementById('exampleUrl2');
        
        // Mettre à jour les exemples d'URL
        if (exampleUrl && exampleUrl2) {
            const baseUrl = window.location.origin;
            exampleUrl.textContent = `${baseUrl}/uploads/fichier.jpg`;
            exampleUrl2.textContent = `${baseUrl}/uploads/fichier.jpg`;
        }

        // Toast Notification System
        function showToast(title, message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toastTitle');
            const toastMsg = document.getElementById('toastMessage');
            const iconContainer = document.getElementById('toastIconContainer');
            const icon = document.getElementById('toastIcon');
            
            const config = {
                success: { color: 'text-emerald-400', bg: 'bg-emerald-500/20', border: 'border-emerald-500', icon: 'fa-check' },
                error: { color: 'text-rose-400', bg: 'bg-rose-500/20', border: 'border-rose-500', icon: 'fa-times' },
                info: { color: 'text-blue-400', bg: 'bg-blue-500/20', border: 'border-blue-500', icon: 'fa-info' },
                warning: { color: 'text-amber-400', bg: 'bg-amber-500/20', border: 'border-amber-500', icon: 'fa-exclamation' }
            };

            const style = config[type] || config.success;

            toast.querySelector('.glass-panel').className = `glass-panel bg-slate-900/90 rounded-2xl p-4 shadow-2xl border-l-4 ${style.border} flex items-center max-w-sm`;
            iconContainer.className = `w-10 h-10 rounded-full ${style.bg} flex items-center justify-center mr-4 shrink-0`;
            icon.className = `fas ${style.icon} ${style.color}`;
            
            toastTitle.textContent = title;
            toastMsg.textContent = message;

            // Animate In
            toast.classList.remove('translate-y-24', 'opacity-0');
            toast.classList.add('translate-y-0', 'opacity-100');
            
            // Auto hide
            setTimeout(() => {
                toast.classList.remove('translate-y-0', 'opacity-100');
                toast.classList.add('translate-y-24', 'opacity-0');
            }, 4000);
        }

        // ===========================================
        // FONCTIONS PRINCIPALES - Compatible server.js
        // ===========================================

        // Charger les statistiques
        async function loadStats() {
            try {
                const response = await fetch(STATS_ENDPOINT);
                const data = await response.json();
                
                if (data.success) {
                    statsFileCount.textContent = data.stats.totalFiles;
                    statsStorageUsed.textContent = data.stats.storageUsed;
                } else {
                    console.error('Erreur chargement stats:', data);
                }
            } catch (error) {
                console.error('Erreur chargement stats:', error);
                // Valeurs par défaut pour le design
                statsFileCount.textContent = "0";
                statsStorageUsed.textContent = "0 MB";
            }
        }

        // Créer une carte de fichier récent
        function createRecentFileCard(file) {
            const iconMap = {
                'image': 'fa-image text-purple-400',
                'video': 'fa-video text-rose-400',
                'audio': 'fa-music text-amber-400',
                'document': 'fa-file-alt text-blue-400',
                'archive': 'fa-file-archive text-yellow-400',
                'default': 'fa-file text-gray-400'
            };
            
            // Déterminer le type basé sur l'extension ou le type retourné par l'API
            let fileType = file.type || 'default';
            if (!iconMap[fileType]) fileType = 'default';
            
            return `
                <div class="flex items-center p-3 rounded-xl bg-white/5 hover:bg-white/10 transition-colors border border-white/5 group cursor-pointer" onclick="copyToClipboard('${file.url}')">
                    <div class="w-10 h-10 rounded-lg bg-gray-800 flex items-center justify-center mr-3 group-hover:scale-110 transition-transform">
                        <i class="fas ${iconMap[fileType]}"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p class="font-semibold text-sm truncate text-gray-200">${file.originalName || file.name}</p>
                        <p class="text-xs text-gray-500">${file.size || 'Taille inconnue'}</p>
                    </div>
                    <button class="w-8 h-8 rounded-full hover:bg-white/10 flex items-center justify-center text-gray-400 hover:text-white transition-colors" title="Copier le lien">
                        <i class="fas fa-copy text-xs"></i>
                    </button>
                </div>
            `;
        }

        // Uploader un fichier
        async function uploadFile(file) {
            // Vérifier la taille (2GB max)
            if (file.size > 2 * 1024 * 1024 * 1024) {
                showToast('Erreur', 'Le fichier dépasse la limite de 2GB', 'error');
                return;
            }

            // Préparer le formulaire
            const formData = new FormData();
            formData.append('file', file);

            // Configurer la progression
            progressContainer.classList.remove('hidden');
            fileNameLabel.textContent = file.name;
            progressBar.style.width = '0%';
            progressPercent.textContent = '0%';

            // Utiliser XMLHttpRequest pour la progression
            const xhr = new XMLHttpRequest();
            
            xhr.upload.addEventListener('progress', (e) => {
                if (e.lengthComputable) {
                    const percent = Math.round((e.loaded / e.total) * 100);
                    progressBar.style.width = `${percent}%`;
                    progressPercent.textContent = `${percent}%`;
                }
            });

            xhr.onload = function() {
                if (xhr.status === 200) {
                    try {
                        const response = JSON.parse(xhr.responseText);
                        if (response.success) {
                            finishUpload(response);
                            // Recharger les stats et fichiers
                            loadStats();
                            loadRecentFiles();
                        } else {
                            showToast('Erreur', response.message || 'Upload échoué', 'error');
                        }
                    } catch (e) {
                        showToast('Erreur', 'Réponse serveur invalide', 'error');
                    }
                } else {
                    showToast('Erreur', `Erreur HTTP ${xhr.status}`, 'error');
                }
                progressContainer.classList.add('hidden');
            };

            xhr.onerror = function() {
                showToast('Erreur', 'Erreur réseau lors de l\'upload', 'error');
                progressContainer.classList.add('hidden');
            };

            // Envoyer la requête
            xhr.open('POST', UPLOAD_ENDPOINT);
            xhr.send(formData);
        }

        // Terminer l'upload
        function finishUpload(response) {
            const file = response;
            showToast('Upload Terminé', `${file.filename || file.originalName} a été ajouté avec succès.`);
            
            // Ajouter à la liste visuelle
            const fileItem = document.createElement('div');
            fileItem.innerHTML = `
                <div class="animate-slide-up flex items-center justify-between p-4 rounded-xl bg-gradient-to-r from-emerald-500/10 to-teal-500/10 border border-emerald-500/20 mb-3">
                    <div class="flex items-center gap-4">
                        <div class="w-10 h-10 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400">
                            <i class="fas fa-check"></i>
                        </div>
                        <div>
                            <p class="font-bold text-sm text-emerald-100">Upload réussi</p>
                            <p class="text-xs text-emerald-200/60 truncate max-w-[200px]">${file.originalName || file.filename}</p>
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <button class="px-3 py-1.5 rounded-lg bg-emerald-500/20 text-emerald-400 text-xs font-bold hover:bg-emerald-500/30 transition-colors" onclick="copyToClipboard('${file.url || file.directUrl}')">
                            COPIER
                        </button>
                    </div>
                </div>
            `;
            fileList.prepend(fileItem);
        }

        // Charger les fichiers récents
        async function loadRecentFiles() {
            try {
                const response = await fetch(FILES_ENDPOINT);
                const data = await response.json();
                
                if (data.success && data.files && data.files.length > 0) {
                    recentFiles.innerHTML = '';
                    // Prendre les 6 fichiers les plus récents
                    data.files.slice(0, 6).forEach(file => {
                        recentFiles.innerHTML += createRecentFileCard(file);
                    });
                } else {
                    recentFiles.innerHTML = `
                        <div class="col-span-full text-center py-10 border border-dashed border-gray-700 rounded-xl">
                            <i class="fas fa-folder-open text-3xl text-gray-600 mb-3"></i>
                            <p class="text-gray-500">Aucun fichier uploadé</p>
                            <p class="text-sm text-gray-600 mt-2">Glissez un fichier dans la zone ci-dessus</p>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Erreur chargement fichiers:', error);
                recentFiles.innerHTML = `
                    <div class="col-span-full text-center py-10 border border-dashed border-gray-700 rounded-xl">
                        <i class="fas fa-exclamation-triangle text-3xl text-amber-600 mb-3"></i>
                        <p class="text-amber-500">Erreur de chargement</p>
                        <p class="text-sm text-gray-600 mt-2">Impossible de charger les fichiers</p>
                    </div>
                `;
            }
        }

        // Copier dans le presse-papier
        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                showToast('Succès', 'Lien copié dans le presse-papier', 'success');
            } catch (err) {
                // Fallback pour anciens navigateurs
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showToast('Succès', 'Lien copié dans le presse-papier', 'success');
            }
        }

        // Copier le lien (pour compatibilité)
        function copyLink() {
            showToast('Info', 'Utilisez le bouton "COPIER" sur un fichier', 'info');
        }

        // ===========================================
        // ÉVÉNEMENTS
        // ===========================================

        // Bouton parcourir
        browseBtn.addEventListener('click', () => fileInput.click());
        
        // Sélection de fichier
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                // Uploader chaque fichier
                Array.from(e.target.files).forEach(file => {
                    uploadFile(file);
                });
                // Réinitialiser l'input
                fileInput.value = '';
            }
        });

        // Drag and drop
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            
            if (e.dataTransfer.files.length > 0) {
                // Uploader chaque fichier
                Array.from(e.dataTransfer.files).forEach(file => {
                    uploadFile(file);
                });
            }
        });

        // ===========================================
        // INITIALISATION
        // ===========================================

        // Au chargement de la page
        document.addEventListener('DOMContentLoaded', () => {
            loadStats();
            loadRecentFiles();
            
            // Tester la connexion API
            fetch('/api/test')
                .then(response => response.json())
                .then(data => {
                    console.log('API Status:', data.status);
                })
                .catch(error => {
                    console.warn('API non disponible:', error);
                    showToast('Attention', 'Le serveur semble hors ligne', 'warning');
                });
        });

        // Exposer certaines fonctions globalement
        window.copyToClipboard = copyToClipboard;
        window.copyLink = copyLink;

    </script>
</body>
                            </html>
